#!/bin/sh

# Script by www.seguridadwireless.net

SCRIPT_VERSION=20160402

############################################################
## Funciones comunes. Su nombre empieza por f_ ##
############################################################
f_variables(){
	. /opt/wifislax-updaters/Funciones/funciones_updater
}

############################################################
## Funciones propias del script. Su nombre empieza por F_ ##
############################################################
# Definicion de variables
F_variables() {
	PRGNAM=libkate
	echo -ne "\033]2;${PRGNAM}_updater\007"
	WEB=https://libkate.googlecode.com/files
	VERSION=0.4.1
	EXTENSION=tar.gz
	SOURCES=$PRGNAM-$VERSION.$EXTENSION
	DOWNLOAD=$WEB/$SOURCES
}

# Descomprimimos el fichero descargado y compilamos
F_compilar(){
echo 
echo "$VERDE"Configurando ..."$CIERRE"
sleep 1

echo "ZGlmZiAtdSAtciBsaWJrYXRlLTAuNC4xLW9yaWcvTWFrZWZpbGUuaW4gbGlia2F0ZS0wLjQuMS9N
YWtlZmlsZS5pbgotLS0gbGlia2F0ZS0wLjQuMS1vcmlnL01ha2VmaWxlLmluCTIwMTEtMDgtMjEg
MjM6NDY6NTguMDAwMDAwMDAwICswMTAwCisrKyBsaWJrYXRlLTAuNC4xL01ha2VmaWxlLmluCTIw
MTUtMDUtMjggMjM6NTI6MjEuMzg5OTQ2OTcxICswMTAwCkBAIC0yNjAsNyArMjYwLDYgQEAKIExE
ID0gQExEQAogTERGTEFHUyA9IEBMREZMQUdTQAogTEVYID0gQExFWEAKLUxFWExJQiA9IEBMRVhM
SUJACiBMRVhfT1VUUFVUX1JPT1QgPSBATEVYX09VVFBVVF9ST09UQAogTElCS0FURV9TSEFSRURf
VkVSU0lPTiA9IEBMSUJLQVRFX1NIQVJFRF9WRVJTSU9OQAogTElCT0JKUyA9IEBMSUJPQkpTQApk
aWZmIC11IC1yIGxpYmthdGUtMC40LjEtb3JpZy9jb25maWd1cmUuYWMgbGlia2F0ZS0wLjQuMS9j
b25maWd1cmUuYWMKLS0tIGxpYmthdGUtMC40LjEtb3JpZy9jb25maWd1cmUuYWMJMjAxMS0wOC0y
MSAyMzo0NDozMi4wMDAwMDAwMDAgKzAxMDAKKysrIGxpYmthdGUtMC40LjEvY29uZmlndXJlLmFj
CTIwMTUtMDUtMzAgMDY6Mjg6MzMuMzA2NjgyNDgxICswMTAwCkBAIC03LDcgKzcsNyBAQAogCiBB
Q19DQU5PTklDQUxfVEFSR0VUCiAKLUFNX0lOSVRfQVVUT01BS0UoWy1XYWxsIC1XZXJyb3IgZm9y
ZWlnbiBzdWJkaXItb2JqZWN0c10pCitBTV9JTklUX0FVVE9NQUtFKFstV2FsbCBmb3JlaWduIHN1
YmRpci1vYmplY3RzXSkKIEFDX0NPTkZJR19IRUFERVJTKFtpbmNsdWRlL2NvbmZpZy5oXSkKIAog
aWZkZWYoW0FNX1NJTEVOVF9SVUxFU10sW0FNX1NJTEVOVF9SVUxFU10pCmRpZmYgLXUgLXIgbGli
a2F0ZS0wLjQuMS1vcmlnL2RvYy9NYWtlZmlsZS5pbiBsaWJrYXRlLTAuNC4xL2RvYy9NYWtlZmls
ZS5pbgotLS0gbGlia2F0ZS0wLjQuMS1vcmlnL2RvYy9NYWtlZmlsZS5pbgkyMDExLTA4LTIxIDIz
OjQ3OjEwLjAwMDAwMDAwMCArMDEwMAorKysgbGlia2F0ZS0wLjQuMS9kb2MvTWFrZWZpbGUuaW4J
MjAxNS0wNS0yOCAyMzo1Mjo0OS43NDIwNTQ1NzIgKzAxMDAKQEAgLTEyNSw3ICsxMjUsNiBAQAog
TEQgPSBATERACiBMREZMQUdTID0gQExERkxBR1NACiBMRVggPSBATEVYQAotTEVYTElCID0gQExF
WExJQkAKIExFWF9PVVRQVVRfUk9PVCA9IEBMRVhfT1VUUFVUX1JPT1RACiBMSUJLQVRFX1NIQVJF
RF9WRVJTSU9OID0gQExJQktBVEVfU0hBUkVEX1ZFUlNJT05ACiBMSUJPQkpTID0gQExJQk9CSlNA
CmRpZmYgLXUgLXIgbGlia2F0ZS0wLjQuMS1vcmlnL3Rlc3RzL01ha2VmaWxlLmluIGxpYmthdGUt
MC40LjEvdGVzdHMvTWFrZWZpbGUuaW4KLS0tIGxpYmthdGUtMC40LjEtb3JpZy90ZXN0cy9NYWtl
ZmlsZS5pbgkyMDExLTA4LTIxIDIzOjQ2OjU4LjAwMDAwMDAwMCArMDEwMAorKysgbGlia2F0ZS0w
LjQuMS90ZXN0cy9NYWtlZmlsZS5pbgkyMDE1LTA1LTI4IDIzOjUyOjM2LjU0MjAwNDQ2MyArMDEw
MApAQCAtMTU2LDcgKzE1Niw2IEBACiBMRCA9IEBMREAKIExERkxBR1MgPSBATERGTEFHU0AKIExF
WCA9IEBMRVhACi1MRVhMSUIgPSBATEVYTElCQAogTEVYX09VVFBVVF9ST09UID0gQExFWF9PVVRQ
VVRfUk9PVEAKIExJQktBVEVfU0hBUkVEX1ZFUlNJT04gPSBATElCS0FURV9TSEFSRURfVkVSU0lP
TkAKIExJQk9CSlMgPSBATElCT0JKU0AKZGlmZiAtdSAtciBsaWJrYXRlLTAuNC4xLW9yaWcvdG9v
bHMvS2F0ZURKL01ha2VmaWxlLmluIGxpYmthdGUtMC40LjEvdG9vbHMvS2F0ZURKL01ha2VmaWxl
LmluCi0tLSBsaWJrYXRlLTAuNC4xLW9yaWcvdG9vbHMvS2F0ZURKL01ha2VmaWxlLmluCTIwMTEt
MDgtMjEgMjM6NDY6NTguMDAwMDAwMDAwICswMTAwCisrKyBsaWJrYXRlLTAuNC4xL3Rvb2xzL0th
dGVESi9NYWtlZmlsZS5pbgkyMDE1LTA1LTI4IDIzOjUzOjExLjk4MTEzOTAxNyArMDEwMApAQCAt
OTksNyArOTksNiBAQAogTEQgPSBATERACiBMREZMQUdTID0gQExERkxBR1NACiBMRVggPSBATEVY
QAotTEVYTElCID0gQExFWExJQkAKIExFWF9PVVRQVVRfUk9PVCA9IEBMRVhfT1VUUFVUX1JPT1RA
CiBMSUJLQVRFX1NIQVJFRF9WRVJTSU9OID0gQExJQktBVEVfU0hBUkVEX1ZFUlNJT05ACiBMSUJP
QkpTID0gQExJQk9CSlNACmRpZmYgLXUgLXIgbGlia2F0ZS0wLjQuMS1vcmlnL3Rvb2xzL01ha2Vm
aWxlLmFtIGxpYmthdGUtMC40LjEvdG9vbHMvTWFrZWZpbGUuYW0KLS0tIGxpYmthdGUtMC40LjEt
b3JpZy90b29scy9NYWtlZmlsZS5hbQkyMDExLTA4LTIxIDEzOjQyOjEwLjAwMDAwMDAwMCArMDEw
MAorKysgbGlia2F0ZS0wLjQuMS90b29scy9NYWtlZmlsZS5hbQkyMDE1LTA1LTI4IDIzOjU0OjAz
LjI5MzMzMzkxNCArMDEwMApAQCAtMjAsNyArMjAsNyBAQAogZW5kaWYKIGthdGVkZWNfU09VUkNF
Uz1rYXRlZGVjLmMga2thdGUuYyBrc3J0LmMga2xyYy5jIGt1dGlsLmMga2Z1enouYyBrc3RyZWFt
LmMga3JlYWQuYyBrc3RyaW5ncy5jCiBrYXRhbHl6ZXJfU09VUkNFUz1rYXRhbHl6ZXIuYyBrdXRp
bC5jIGtzdHJlYW0uYyBrcmVhZC5jIGtzdHJpbmdzLmMga3N0YXRzLmMKLWthdGVlbmNfTERBREQ9
Li4vbGliL2xpYm9nZ2thdGUubGEgLi4vbGliL2xpYmthdGUubGEgQE9HR19MSUJTQCBAUE5HX0xJ
QlNAIEBMRVhMSUJACitrYXRlZW5jX0xEQUREPS4uL2xpYi9saWJvZ2drYXRlLmxhIC4uL2xpYi9s
aWJrYXRlLmxhIEBPR0dfTElCU0AgQFBOR19MSUJTQAoga2F0ZWRlY19MREFERD0uLi9saWIvbGli
b2dna2F0ZS5sYSAuLi9saWIvbGlia2F0ZS5sYSBAT0dHX0xJQlNACiBrYXRhbHl6ZXJfTERBREQ9
Li4vbGliL2xpYm9nZ2thdGUubGEgLi4vbGliL2xpYmthdGUubGEgQE9HR19MSUJTQAoga2F0ZWVu
Y19DRkxBR1M9QENXQVJORkxBR1NfTElHSFRAIEBDRkxBR1NfRk9SVElGWV9TT1VSQ0VAIEBDRkxB
R1NfREVCVUdAIEBPR0dfQ0ZMQUdTQCBAUE5HX0NGTEFHU0AKZGlmZiAtdSAtciBsaWJrYXRlLTAu
NC4xLW9yaWcvdG9vbHMvTWFrZWZpbGUuaW4gbGlia2F0ZS0wLjQuMS90b29scy9NYWtlZmlsZS5p
bgotLS0gbGlia2F0ZS0wLjQuMS1vcmlnL3Rvb2xzL01ha2VmaWxlLmluCTIwMTEtMDgtMjEgMjM6
NDY6NTguMDAwMDAwMDAwICswMTAwCisrKyBsaWJrYXRlLTAuNC4xL3Rvb2xzL01ha2VmaWxlLmlu
CTIwMTUtMDUtMjggMjM6NTQ6MjEuODA1NDA0MjcwICswMTAwCkBAIC0yMjMsNyArMjIzLDYgQEAK
IExEID0gQExEQAogTERGTEFHUyA9IEBMREZMQUdTQAogTEVYID0gQExFWEAKLUxFWExJQiA9IEBM
RVhMSUJACiBMRVhfT1VUUFVUX1JPT1QgPSBATEVYX09VVFBVVF9ST09UQAogTElCS0FURV9TSEFS
RURfVkVSU0lPTiA9IEBMSUJLQVRFX1NIQVJFRF9WRVJTSU9OQAogTElCT0JKUyA9IEBMSUJPQkpT
QApAQCAtMzUxLDcgKzM1MCw3IEBACiBASEFWRV9PR0dfVFJVRUAJJChhbV9fYXBwZW5kXzEpCiBA
SEFWRV9PR0dfVFJVRUBrYXRlZGVjX1NPVVJDRVMgPSBrYXRlZGVjLmMga2thdGUuYyBrc3J0LmMg
a2xyYy5jIGt1dGlsLmMga2Z1enouYyBrc3RyZWFtLmMga3JlYWQuYyBrc3RyaW5ncy5jCiBASEFW
RV9PR0dfVFJVRUBrYXRhbHl6ZXJfU09VUkNFUyA9IGthdGFseXplci5jIGt1dGlsLmMga3N0cmVh
bS5jIGtyZWFkLmMga3N0cmluZ3MuYyBrc3RhdHMuYwotQEhBVkVfT0dHX1RSVUVAa2F0ZWVuY19M
REFERCA9IC4uL2xpYi9saWJvZ2drYXRlLmxhIC4uL2xpYi9saWJrYXRlLmxhIEBPR0dfTElCU0Ag
QFBOR19MSUJTQCBATEVYTElCQAorQEhBVkVfT0dHX1RSVUVAa2F0ZWVuY19MREFERCA9IC4uL2xp
Yi9saWJvZ2drYXRlLmxhIC4uL2xpYi9saWJrYXRlLmxhIEBPR0dfTElCU0AgQFBOR19MSUJTQAog
QEhBVkVfT0dHX1RSVUVAa2F0ZWRlY19MREFERCA9IC4uL2xpYi9saWJvZ2drYXRlLmxhIC4uL2xp
Yi9saWJrYXRlLmxhIEBPR0dfTElCU0AKIEBIQVZFX09HR19UUlVFQGthdGFseXplcl9MREFERCA9
IC4uL2xpYi9saWJvZ2drYXRlLmxhIC4uL2xpYi9saWJrYXRlLmxhIEBPR0dfTElCU0AKIEBIQVZF
X09HR19UUlVFQGthdGVlbmNfQ0ZMQUdTID0gQENXQVJORkxBR1NfTElHSFRAIEBDRkxBR1NfRk9S
VElGWV9TT1VSQ0VAIEBDRkxBR1NfREVCVUdAIEBPR0dfQ0ZMQUdTQCBAUE5HX0NGTEFHU0AK
" | base64 -d > $TMP/no-flex.patch

patch -p1 -i $TMP/no-flex.patch || exit 1

libtoolize --copy --force
aclocal
automake --add-missing --copy --force-missing

CFLAGS="$SLKCFLAGS" \
./configure \
  --prefix=/usr \
  --exec-prefix=/usr \
  --sysconfdir=/etc \
  --libdir=/usr/lib${LIBDIRSUFFIX} \
  --disable-doc \
  --build=$ARCH-slackware-linux

echo 
echo "$VERDE"Compilando ..."$CIERRE"
sleep 1

make || exit 1
make install DESTDIR=$PKG || exit 1
}

###################################
## BLOQUE PRINCIPAL DE EJECUCION ##
###################################
# Si se cierra el script inesperadamente, ejecutar la funcion de limpieza
trap f_exitmode SIGHUP SIGINT

#Inicializamos las variables globales
f_variables
#Asignamos o detectamos arquitectura
f_arquitectura
#Comprobamos conexion a Internet
f_comprobarConexion
#Inicializamos las variables del script
F_variables
#Creamos directorio de trabajo
f_directorioTemporal
#Mostramos el mensaje de presentacion
f_presentacion
#Comprobamos updates del script
f_comprobarUpdates
#Comprobamos version instalada del paquete
f_versionInstalada
#Compronar dependencias
#F_dependencias
#Si no existe el fichero se descargara
f_download
#Preparamos entorno
f_preparar
#Descomprimir fichero descargado y compilamos
F_compilar
#Hacemos strip sobre el paquete
f_strip
#Creamos xzm , instalamos y salimos
f_tareasFinales